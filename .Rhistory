library(devtools)
library(readr)
test_data <- read_csv("bronch test data.csv")
test_data <- read_csv("bronch test data.csv")
library(tidyr)
demo_data <- test_data
library(dplyr)
demo_data <-
test_data %>%
select(VISIT_KEY, PAT_KEY, METRIC = ALBUTEROL_ED_IND, PRIMARY_LANG, RACE, PAYER_TYPE)
#Gather
demo_pivot <-
demo_data %>%
gather(demo_group, demo_value, -VISIT_KEY, -PAT_KEY, -METRIC)
View(demo_pivot)
library(ggplot2)
ggplot(data = filter(demo_pivot, demo_group == "RACE"))
filter(demo_pivot, demo_group == "RACE")
ggplot(data = filter(demo_pivot, demo_group == "RACE"), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean") +
labs(x = "RACE")
make_demo_plot <- function(demo){
ggplot(data = filter(demo_pivot, demo_group == demo), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean") +
labs(x = demo)
}
make_demo_plot("RACE")
make_demo_plot("PRIMARY_LANG")
make_demo_plot("PAYER_TYPE")
library(purrr)
demo_plots <- map(demo_vars, make_demo_plot)
#Define the demos here by their SQL columns names
demo_vars <- c("RACE", "PAYER_TYPE", "PRIMARY_LANG")
demo_plots <- map(demo_vars, make_demo_plot)
demo_plots
make_demo_plot <- function(demo){
ggplot(data = filter(demo_pivot, demo_group == demo), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean", fill = "#50a0f0") +
labs(x = demo)
}
demo_plots <- map(demo_vars, make_demo_plot)
demo_plots
library(ggthemes)
ggplot(data = filter(demo_pivot, demo_group == demo), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean", fill = "#50a0f0") +
theme_few() +
labs(x = demo)
make_demo_plot <- function(demo){
ggplot(data = filter(demo_pivot, demo_group == demo), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean", fill = "#50a0f0") +
theme_few() +
labs(x = demo)
}
demo_plots <- map(demo_vars, make_demo_plot)
demo_plots
METRIC <- "ALBUTEROL_IND"
make_demo_plot <- function(demo){
ggplot(data = filter(demo_pivot, demo_group == demo), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean", fill = "#50a0f0") +
theme_few() +
labs(x = demo, title = paste(METRIC, "stratified by", demo))
}
demo_plots <- map(demo_vars, make_demo_plot)
demo_plots
make_demo_plot <- function(demo){
ggplot(data = filter(demo_pivot, demo_group == demo), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean", fill = "#50a0f0") +
geom_text(aes(label = mean(METRIC)))
theme_few() +
labs(x = demo, y = "AVERAGE", title = paste(METRIC, "stratified by", demo))
}
demo_plots <- map(demo_vars, make_demo_plot)
demo_plots
make_demo_plot <- function(demo){
ggplot(data = filter(demo_pivot, demo_group == demo), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean", fill = "#50a0f0") +
geom_text(aes(label = mean(METRIC))) +
theme_few() +
labs(x = demo, y = "AVERAGE", title = paste(METRIC, "stratified by", demo))
}
demo_plots <- map(demo_vars, make_demo_plot)
demo_plots
make_demo_plot <- function(demo){
ggplot(data = filter(demo_pivot, demo_group == demo), aes(x = demo_value, y = METRIC)) +
geom_bar(stat = "summary", fun.y = "mean", fill = "#50a0f0") +
theme_few() +
labs(x = demo, y = "AVERAGE", title = paste(METRIC, "stratified by", demo))
}
library(usethis)
library(devtools)
usethis::create_package("demographics")
usethis::create_package("demographics")
usethis::create_package("package/demographics")
